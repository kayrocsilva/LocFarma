import React, { useEffect, useState } from 'react'
import { useLocation } from 'react-router-dom'
import { db } from '../../firebase/config'

const SearchBarResults = () => {
  const location = useLocation();
  const searchTerm = new URLSearchParams(location.search).get('q');
  const [medicamentos, setMedicamentos] = useState([]);

  useEffect(() => {
    const fetchMedicamentos = async () => {
      const medicamentosRef = db.collection('medicamentos');
      const querySnapshot = await medicamentosRef.where('nome', '==', searchTerm).get();
      const medicamentosData = querySnapshot.docs.map(doc => doc.data());
      setMedicamentos(medicamentosData);
    };

    fetchMedicamentos();
  }, [searchTerm]);

  return (
    <div>
      <h2>Resultados da busca por: {searchTerm}</h2>
      <ul>
        {medicamentos.map((medicamento, index) => (
          <li key={index}>
            <p>Nome: {medicamento.nome}</p>
            <p>Farmácias:</p>
            <ul>
              {medicamento.farmacias.map((farmacia, index) => (
                <li key={index}>
                  <p>Nome: {farmacia.nome}</p>
                  <p>Endereço: {farmacia.endereco}</p>
                </li>
              ))}
            </ul>
          </li>
        ))}
      </ul>
    </div>
  )
}

export default SearchBarResults
